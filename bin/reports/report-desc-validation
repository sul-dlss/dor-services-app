#!/usr/bin/env ruby
# frozen_string_literal: true

require_relative '../../config/environment'
require_relative '../../lib/report'

# This report is useful for testing cocina model changes that affect desc metadata,
# including validation changes.
# It may be useful to reference unreleased cocina models in Gemfile.
Report.new(name: 'desc-validation', dsids: ['descMetadata']).run do |ng_xml|
  props = Cocina::Models::Mapping::FromMods::Description.props(
    mods: ng_xml,
    # druid and label are fake.
    druid: 'druid:bb042rt9930',
    label: 'foo'
  )
  Cocina::Models::Description.new(props)
  false
rescue Cocina::Models::ValidationError => e
  e.message.delete_prefix('Unrecognized types in description: ')
end
