#!/usr/bin/env ruby
# frozen_string_literal: true

require_relative '../../config/environment'
require_relative '../../lib/report'

Report.new(name: 'desc-identifier_specific_types', dsids: ['descMetadata']).run do |ng_xml|
  specific_types = [
    'apis',
    'naf',
    'swets',
    'vintage',
    'Wikidata Item'
  ].freeze

  xpath_predicate = specific_types.map { |type| "@type='#{type}'" }.join(' or ')

  ng_xml
    .xpath("//mods:identifier[#{xpath_predicate}]", mods: MODS_NS)
    .map { |identifier_element| identifier_element.attribute('type').content }
    .join(', ')
    .presence
end
